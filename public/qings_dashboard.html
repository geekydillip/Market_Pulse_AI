<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Dashboard - Market Pulse</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="stylesheet" href="styles.css" />
  <style>
    /* Navigation styles */
    .nav-button {
        position: absolute;
        top: 20px;
        left: 20px;
        background: var(--card-bg);
        border: 1px solid rgba(0,0,0,0.1);
        border-radius: 16px;
        width: 120px;
        height: 48px;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 6px 6px 12px rgba(0,0,0,0.1), -6px -6px 12px rgba(255,255,255,0.9);
        z-index: 100;
        text-decoration: none;
        color: var(--text-primary);
        font-size: 14px;
        font-weight: 600;
    }

    .nav-button:hover {
        transform: translateY(-2px);
        box-shadow: 8px 8px 16px rgba(0,0,0,0.15), -8px -8px 16px rgba(255,255,255,0.9);
    }

    .theme-toggle {
        position: absolute;
        top: 20px;
        right: 20px;
        background: var(--card-bg);
        border: 1px solid rgba(0,0,0,0.1);
        border-radius: 16px;
        width: 120px;
        height: 48px;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 6px 6px 12px rgba(0,0,0,0.1), -6px -6px 12px rgba(255,255,255,0.9);
        z-index: 100;
        color: var(--text-primary);
        font-size: 14px;
        font-weight: 600;
    }

    .theme-toggle:hover {
        transform: translateY(-2px);
        box-shadow: 8px 8px 16px rgba(0,0,0,0.15), -8px -8px 16px rgba(255,255,255,0.9);
    }

    .theme-toggle::before {
        content: "Light";
    }

    body.theme-dark .theme-toggle::before {
        content: "Dark";
    }

    /* Chart color overrides for strong severity contrast */
    :root {
      --chart-critical-start: #dc2626;
      --chart-critical-end:   #b91c1c;
      --chart-high-start:     #ea580c;
      --chart-high-end:       #c2410c;
      --chart-middle-start:   #ca8a04;
      --chart-middle-end:     #a16207;
      --chart-low-start:      #16a34a;
      --chart-low-end:        #15803d;
    }

    /* quick overrides specific to this page (kept minimal) - updated for neumorphic design */
    .dashboard-container { max-width:1600px; margin:80px auto 20px auto; padding: 24px; display: grid; grid-template-columns: 260px 1fr; gap:24px; background: var(--bg); border-radius: 20px; box-shadow: inset 8px 8px 16px rgba(0,0,0,0.1), inset -8px -8px 16px rgba(255,255,255,0.1); }
    .model-list {
        display: flex;
        flex-direction: column;
        gap: 12px;
        padding: 16px;
        max-height: calc(100vh - 160px);
        overflow-y: auto;
        scrollbar-width: thin;
        scrollbar-color: rgba(0,0,0,0.3) rgba(0,0,0,0.1);
    }
    .model-list::-webkit-scrollbar {
        width: 6px;
    }
    .model-list::-webkit-scrollbar-track {
        background: rgba(0,0,0,0.1);
        border-radius: 3px;
    }
    .model-list::-webkit-scrollbar-thumb {
        background: rgba(0,0,0,0.3);
        border-radius: 3px;
    }
    .model-list::-webkit-scrollbar-thumb:hover {
        background: rgba(0,0,0,0.5);
    }
    .model-chip {
        padding: 14px 20px;
        border-radius: 16px;
        cursor: pointer;
        font-weight: 600;
        text-align: left;
        background: var(--card-bg);
        border: none;
        box-shadow: 6px 6px 12px rgba(0,0,0,0.1), -6px -6px 12px rgba(255,255,255,0.9);
        transition: all 0.3s ease;
        color: var(--text-primary);
        word-wrap: break-word;
        line-height: 1.4;
    }
    .model-chip:hover {
        transform: translateY(-2px);
        box-shadow: 8px 8px 16px rgba(0,0,0,0.15), -8px -8px 16px rgba(255,255,255,0.9);
    }
    .model-chip.active {
        background: linear-gradient(135deg, rgba(59,130,246,0.15), rgba(34,197,94,0.15));
        box-shadow: inset 4px 4px 8px rgba(0,0,0,0.1), inset -4px -4px 8px rgba(255,255,255,0.1);
        border: 2px solid rgba(59,130,246,0.5);
    }
    .section { margin-bottom: 10px; }
    .section h3 { margin: 0 0 16px 0; font-size: 20px; font-weight: 600; color: var(--accent); }
    .chart-card h4 { margin:0 0 16px 0; font-size:18px; font-weight:600; color: var(--accent); }
    .dashboard-main { display:flex; flex-direction:column; gap:5px; }
    .cards-row {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
        margin-bottom: 20px;
    }
    .card {
        padding: 28px;
        border-radius: 16px;
        background: var(--card-bg);
        border: none;
        box-shadow: 10px 10px 20px rgba(0,0,0,0.15), -10px -10px 20px rgba(255,255,255,0.9);
        display: flex;
        align-items: center;
        gap: 20px;
        min-height: 120px;
        transition: all 0.3s ease;
    }
    .card:hover {
        transform: translateY(-3px);
        box-shadow: 12px 12px 24px rgba(0,0,0,0.2), -12px -12px 24px rgba(255,255,255,0.9);
    }
    .card-icon {
        font-size: 40px;
        min-width: 40px;
        text-align: center;
        color: var(--accent);
        flex-shrink: 0;
    }
    .card-content {
        flex: 1;
        display: flex;
        flex-direction: column;
        justify-content: center;
    }
    .card-title {
        font-size: 14px;
        opacity: 0.7;
        margin-bottom: 8px;
        font-weight: 500;
    }
    .card-value {
        font-size: 32px;
        font-weight: 700;
        color: var(--text-primary);
        line-height: 1.2;
    }
    .charts-row { display:grid; grid-template-columns: 1fr 1fr; gap:16px; }
    .chart-card { border-radius:20px; background: var(--card-bg); box-shadow: var(--shadow); padding: 24px; height: 400px; position: relative; }
    body.theme-dark .chart-card { box-shadow: var(--shadow), 0 0 15px rgba(255, 255, 255, 0.1); }
    .chart-card h4 { margin:0 0 16px 0; font-size:18px; font-weight:600; }
    .chart-canvas { display: block; width: 100%; height: 100%; }
    .table-section { border-radius:20px; background: var(--card-bg); box-shadow: 8px 8px 16px rgba(0,0,0,0.1), -8px -8px 16px rgba(255,255,255,0.1); padding: 24px; }
    .table-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:16px; }
    .table-header h4 { margin:0; font-size:18px; font-weight:600; }
    .table-count { opacity:0.7; font-size:14px; }
    #tableWrapper { max-height:500px; overflow:auto; border-radius:12px; }
    .table-glass table {
        width:100%;
        border-collapse:collapse;
        font-size:14px;
        background: rgba(0,0,0,0.02);
        border-radius:12px;
        overflow: hidden;
        table-layout: fixed;
    }
    .table-glass thead th {
        text-align:left;
        padding:16px 12px;
        font-weight:600;
        color:var(--text-primary);
        background: var(--card-bg);
        position: sticky;
        top:0;
        border-bottom: 2px solid rgba(0,0,0,0.1);
    }
    .table-glass tbody td {
        padding:16px 12px;
        border-bottom:1px solid rgba(0,0,0,0.05);
        color: var(--text-primary);
        overflow: hidden;
        text-overflow: ellipsis;
    }
    .table-glass thead th:last-child,
    .table-glass tbody td:last-child { text-align: center; width: 80px; }
    .table-glass thead th:nth-child(1) { width: 60px; text-align: center; }
    .table-glass thead th:nth-child(2) { width: 120px; }
    .table-glass thead th:nth-child(3) { width: 180px; }
    .table-glass thead th:nth-child(4) { width: auto; }
  </style>
</head>
<body>
  <!-- Navigation Buttons -->
  <a href="/" class="nav-button home-button" title="Back to Home">
    <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M3 12L21 12M3 12l6-6M3 12l6 6"/>
    </svg>
    <span>Home</span>
  </a>

  <!-- Theme Toggle -->
  <button id="themeToggle" class="theme-toggle" title="Toggle Theme">
    <svg width="24" height="24" fill="currentColor">
      <circle cx="12" cy="12" r="5"/><path d="m12 1v2m0 18v2M4.93 4.93l1.41 1.41m11.32 0l1.41 -1.41M1 12h2m18 0h2M4.93 19.07l1.41 -1.41m11.32 0l1.41 1.41"/>
    </svg>
  </button>

  <div class="dashboard-container">
    <aside class="section sidebar">
      <h3 class="section-title">Models</h3>
      <div id="modelButtons" class="model-list"></div>
    </aside>

    <main class="dashboard-main">
      <section class="overview-section section">
        <h3 class="section-title">QINGS Overview</h3>
        <div class="cards-row kpi-grid" id="cardsRow">
          <div class="card kpi">
            <div class="card-icon">ðŸ“Š</div>
            <div class="card-content">
              <span class="card-value value" id="dashTotal">â€”</span>
              <div class="label">Total Cases</div>
            </div>
          </div>
          <div class="card kpi">
            <div class="card-icon">ðŸš¨</div>
            <div class="card-content">
              <span class="card-value value" id="dashCritical">â€”</span>
              <div class="label">Critical</div>
            </div>
          </div>
          <div class="card kpi">
            <div class="card-icon">ðŸ”§</div>
            <div class="card-content">
              <span class="card-value value" id="dashDistinct">â€”</span>
              <div class="label">Distinct Modules</div>
            </div>
          </div>
        </div>
      </section>

      <section class="charts-section section">
        <h3 class="section-title">Analytics</h3>
        <div class="charts-row">
          <div class="chart-card charts-card">
            <h4>Severity Distribution</h4>
            <canvas id="severityChart" class="chart-canvas"></canvas>
          </div>
          <div class="chart-card charts-card">
            <h4>Module Distribution</h4>
            <canvas id="moduleChart" class="chart-canvas"></canvas>
          </div>
        </div>
        <div style="text-align: center; margin-top: 8px; opacity: 0.7; font-size: 14px;" id="moduleCount">â€” modules</div>
      </section>

      <section class="cases-section section">
        <div class="table-section">
          <div class="table-header">
            <h4>Cases</h4>
            <div class="table-count" id="tableCount">0 rows</div>
          </div>
          <div id="tableWrapper">
            <table id="dataTable" class="data-table">
              <thead>
                <tr>
                  <th>S/N</th>
                  <th>Model No.</th>
                  <th>Critical Module</th>
                  <th>Top Issue Title</th>
                  <th>Count</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </section>
    </main>
  </div>

  <!-- Modal Dialog -->
  <div id="moduleModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 id="modalTitle">Module Details</h3>
        <button class="modal-close" id="modalClose">&times;</button>
      </div>
      <div class="modal-body">
        <table class="modal-table" id="modalTable">
          <thead>
            <tr>
              <th>Case Code</th>
              <th>Model No.</th>
              <th>S/W Ver.</th>
              <th>Title</th>
              <th>Problem</th>
              <th>Sub-Module</th>
              <th>Severity</th>
              <th>Severity Reason</th>
            </tr>
          </thead>
          <tbody id="modalBody"></tbody>
        </table>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="dashboard.js"></script>
</body>
</html>
