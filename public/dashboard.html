<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Dashboard - Market Pulse</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="stylesheet" href="styles.css" />
  <style>
    /* quick overrides specific to this page (kept minimal) - updated for neumorphic design */
    .dashboard-container { max-width:1600px; margin:20px auto; padding: 24px; display: grid; grid-template-columns: 220px 1fr; gap:24px; background: var(--bg); border-radius: 20px; box-shadow: inset 8px 8px 16px rgba(0,0,0,0.1), inset -8px -8px 16px rgba(255,255,255,0.1); }
    .model-list { display:flex; flex-direction: column; gap:8px; }
    .model-chip { padding:12px 16px; border-radius:16px; cursor:pointer; font-weight: 500; background: var(--card-bg); border: none; box-shadow: 4px 4px 8px rgba(0,0,0,0.1), -4px -4px 8px rgba(255,255,255,0.1); transition: all 0.2s ease; }
    .model-chip:hover { box-shadow: 6px 6px 12px rgba(0,0,0,0.15), -6px -6px 12px rgba(255,255,255,0.15), inset 2px 2px 4px rgba(0,0,0,0.05); }
    .model-chip.active { background: linear-gradient(135deg, rgba(165,207,252,0.1), rgba(144,238,144,0.1)); box-shadow: inset 4px 4px 8px rgba(0,0,0,0.1), inset -4px -4px 8px rgba(255,255,255,0.1); }
    .section { margin-bottom: 10px; }
    .section h3 { margin: 0 0 16px 0; font-size: 20px; font-weight: 600; color: var(--text-primary); }
    .dashboard-main { display:flex; flex-direction:column; gap:5px; }
    .cards-row { display:grid; grid-template-columns: repeat(auto-fit, minmax(280px,1fr)); gap:16px; }
    .card { padding:24px; border-radius:20px; background: var(--card-bg); border: none; box-shadow: 8px 8px 16px rgba(0,0,0,0.1), -8px -8px 16px rgba(255,255,255,0.1); display: flex; align-items: center; gap: 16px; }
    .card-icon { font-size: 32px; color: var(--accent); }
    .card-content { flex: 1; }
    .card-title { font-size:16px; opacity:0.7; margin-bottom: 4px; }
    .card-value { font-size:36px; font-weight:700; color: var(--text-primary); }
    .charts-row { display:grid; grid-template-columns: 1fr 1fr; gap:16px; }
    .chart-card { border-radius:20px; background: var(--card-bg); box-shadow: var(--shadow); padding: 24px; height: 400px; position: relative; }
    .chart-card h4 { margin:0 0 16px 0; font-size:18px; font-weight:600; }
    .chart-canvas { display: block; width: 100%; height: 100%; }
    .table-section { border-radius:20px; background: var(--card-bg); box-shadow: 8px 8px 16px rgba(0,0,0,0.1), -8px -8px 16px rgba(255,255,255,0.1); padding: 24px; }
    .table-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:16px; }
    .table-header h4 { margin:0; font-size:18px; font-weight:600; }
    .table-count { opacity:0.7; font-size:14px; }
    #tableWrapper { max-height:500px; overflow:auto; border-radius:12px; }
    .table-glass table { width:100%; border-collapse:collapse; font-size:14px; background: rgba(0,0,0,0.02); border-radius:12px; overflow: hidden; }
    .table-glass thead th { text-align:left; padding:16px; font-weight:600; color:var(--text-primary); background: rgba(255,255,255,0.05); position: sticky; top:0; }
    .table-glass tbody td { padding:16px; border-bottom:1px solid rgba(0,0,0,0.05); color: var(--text-primary); }
    .table-glass thead th:last-child, .table-glass tbody td:last-child { text-align: center; }
  </style>
</head>
<body>
  <!-- Navigation Buttons -->
  <a href="/" class="nav-button home-button" title="Back to Home">
    <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M3 12L21 12M3 12l6-6M3 12l6 6"/>
    </svg>
  </a>

  <!-- Theme Toggle -->
  <button id="themeToggle" class="theme-toggle" title="Toggle Theme">
    <svg width="24" height="24" fill="currentColor">
      <circle cx="12" cy="12" r="5"/><path d="m12 1v2m0 18v2M4.93 4.93l1.41 1.41m11.32 0l1.41 -1.41M1 12h2m18 0h2M4.93 19.07l1.41 -1.41m11.32 0l1.41 1.41"/>
    </svg>
  </button>

  <div class="dashboard-container">
    <aside class="section sidebar">
      <h3 class="section-title">Models</h3>
      <div id="modelButtons" class="model-list"></div>
    </aside>

    <main class="dashboard-main">
      <section class="overview-section section">
        <h3 class="section-title">Overview</h3>
        <div class="cards-row kpi-grid" id="cardsRow">
          <div class="card kpi">
            <div class="card-icon">ðŸ“Š</div>
            <div class="card-content">
              <span class="card-value value" id="dashTotal">â€”</span>
              <div class="label">Total Cases</div>
            </div>
          </div>
          <div class="card kpi">
            <div class="card-icon">ðŸš¨</div>
            <div class="card-content">
              <span class="card-value value" id="dashCritical">â€”</span>
              <div class="label">Critical</div>
            </div>
          </div>
          <div class="card kpi">
            <div class="card-icon">ðŸ”§</div>
            <div class="card-content">
              <span class="card-value value" id="dashDistinct">â€”</span>
              <div class="label">Distinct Modules</div>
            </div>
          </div>
        </div>
      </section>

      <section class="charts-section section">
        <h3 class="section-title">Analytics</h3>
        <div class="charts-row">
          <div class="chart-card charts-card">
            <h4>Severity Distribution</h4>
            <canvas id="severityChart" class="chart-canvas"></canvas>
          </div>
          <div class="chart-card charts-card">
            <h4>Module Distribution</h4>
            <canvas id="moduleChart" class="chart-canvas"></canvas>
          </div>
        </div>
        <div style="text-align: center; margin-top: 8px; opacity: 0.7; font-size: 14px;" id="moduleCount">â€” modules</div>
      </section>

      <section class="cases-section section">
        <div class="table-section">
          <div class="table-header">
            <h4>Cases</h4>
            <div class="table-count" id="tableCount">0 rows</div>
          </div>
          <div id="tableWrapper">
            <table id="dataTable" class="data-table">
              <thead>
                <tr>
                  <th>S/N</th>
                  <th>Model No.</th>
                  <th>Critical Module</th>
                  <th>Top Issue Title</th>
                  <th>Count</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </section>
    </main>
  </div>

  <!-- Modal Dialog -->
  <div id="moduleModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 id="modalTitle">Module Details</h3>
        <button class="modal-close" id="modalClose">&times;</button>
      </div>
      <div class="modal-body">
        <table class="modal-table" id="modalTable">
          <thead>
            <tr>
              <th>Case Code</th>
              <th>Model No.</th>
              <th>S/W Ver.</th>
              <th>Title</th>
              <th>Problem</th>
              <th>Sub-Module</th>
              <th>Severity</th>
              <th>Severity Reason</th>
            </tr>
          </thead>
          <tbody id="modalBody"></tbody>
        </table>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="dashboard.js"></script>
</body>
</html>
